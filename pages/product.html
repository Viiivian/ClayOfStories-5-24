<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>clayofstories</title>
    <link rel="icon" href="../imagesAll/indexPic/video-icon2.png">
    <link rel="stylesheet" href="../css/default-set.css">
    <link rel="stylesheet" href="../css/product.css">
</head>

<body>
    <!-- 頁首區 -->
    <header class="topbar">
        <div class="container">
            <div class="left-bar">
                <div class="nav-box">
                    <button class="hamburger">
                        <span class="bar"></span>
                        <span class="bar"></span>
                        <span class="bar"></span>
                    </button>
                    <div class="navigation">
                        <ul class="menu">
                            <li><a href="../index.html">HOME</a></li>
                            <li><a href="./about.html">ABOUT</a></li>
                            <li><a href="./allproduct.html">PRODUCT</a></li>
                            <li><a href="./customintro.html">CUSTOM</a></li>
                            <li><a href="./contact.html">CONTACT</a></li>
                        </ul>
                    </div>
                </div>
                <h1 class="logo">
                    <a class="logo-s" href="../index.html"><img src="../imagesAll/indexPic/Logo-s.png" alt="品牌LOGO"></a>

                    <a class="logo-m" href="../index.html"><img src="../imagesAll/indexPic/newlogo.png"
                            alt="品牌LOGO"></a>
                </h1>

                <nav>
                    <ul class="menu">
                        <li><a href="../index.html" class="home">
                                <span class="translate-en">HOME</span>
                                <span class="translate-ch">首頁</span>
                            </a> </li>

                        <li><a href="./about.html" class="about">
                                <span class="translate-en">ABOUT</span>
                                <span class="translate-ch">關於</span>
                            </a></li>

                        <li class="product"> <a href="./allproduct.html" class="product">
                                <span class="translate-en">PRODUCT</span>
                                <span class="translate-ch">所有產品</span>
                            </a>

                            <!-- 下拉式選單 -->
                            <ul class="menu-drop-L">
                                <li>
                                    <a href="./allproduct.html">
                                        <div class="drop-category">
                                            <img src="../imagesAll/indexPic/menu-icon1.png" alt="" />
                                            <h3>VIEW ALL</h3>
                                        </div>
                                    </a>
                                </li>

                                <li><a href="./allproduct.html">
                                        <div class="drop-category">
                                            <img src="../imagesAll/indexPic/menu-icon2.png" alt="" />
                                            <h3>MIRROR</h3>
                                        </div>
                                    </a></li>

                                <li><a href="./allproduct.html">
                                        <div class="drop-category">
                                            <img src="../imagesAll/indexPic/menu-icon3.png" alt="" />
                                            <h3>TRAY</h3>
                                        </div>
                                    </a></li>

                                <li> <a href="./allproduct.html">
                                        <div class="drop-category">
                                            <img src="../imagesAll/indexPic/menu-icon4.png" alt="" />
                                            <h3>ACCESSORY</h3>
                                        </div>
                                    </a></li>

                                <li><a href="./allproduct.html">
                                        <div class="drop-category">
                                            <img src="../imagesAll/indexPic/menu-icon5.png" alt="" />
                                            <h3>VASE</h3>
                                        </div>
                                    </a></li>
                                <li><a href="./allproduct.html">
                                        <div class="drop-category">
                                            <img src="../imagesAll/indexPic/menu-icon6.png" alt="" />
                                            <h3>HOLDER</h3>
                                        </div>
                                    </a></li>
                            </ul>
                        </li>


                        <li><a href="./customintro.html" class="customized">
                                <span class="translate-en">CUSTOM</span>
                                <span class="translate-ch">客製化</span>
                            </a></li>
                        <li><a href="./contact.html" class="contact">
                                <span class="translate-en">CONTACT</span>
                                <span class="translate-ch">聯絡我們</span>
                            </a></li>
                    </ul>
                </nav>
            </div>

            <ul class="right-bar icon">
                <li><a href="#" class="icon-search"></a></li>
                <li><a href="./login.html" class="icon-user"></a></li>
                <li><a href="./fqa.html" class="icon-fqa"></a></li>
                <li><a href="./shopcart.html" class="icon-cart cart" id="shopCart"></a></li>
                <span class="cart-count" id="cart-count">0</span>
            </ul>
        </div>

    </header>


    <!-- 主要內容區 -->
    <main>
        <section class="bgimg">
            <div id="root">
            </div>
        </section>
    </main>

    <!-- 頁尾區 -->
    <footer>
        <div class="footer-container">
            <!-- section 1 -->
            <div class="menu">
                <ul class="menu-1">
                    <li><a href="../index.html">HOME</a></li>
                    <li><a href="./about.html">ABOUT</a></li>
                    <li><a href="./allproduct.html">PRODUCT</a></li>

                </ul>

                <ul class="menu-2">
                    <li><a href="./customintro.html">CUSTOMIZED</a></li>
                    <li><a href="./contact.html">CONTACT</a></li>
                    <li><a href="./fqa.html">FAQ</a></li>
                </ul>

            </div>
            <div class="border-s border"></div>

            <!-- section 2 -->
            <div class="container">
                <ul class="icons">
                    <li><img src="../imagesAll/indexPic/footer-icon1.png" alt=""></li>
                    <li><img src="../imagesAll/indexPic/footer-icon2.png" alt=""></li>
                    <li><img src="../imagesAll/indexPic/footer-icon3.png" alt=""></li>
                </ul>

                <div class="border"></div>

                <p>Copyright © ClayOfStories 2024 All Rights Reserved</p>
            </div>

            <!-- section 3 -->
            <div class="information">
                <h4>CONTACT US</h4>
                <p>clayofstories@gmail.com</p>
                <p>0800-523-066</p>
                <ul class="social-media">
                    <li><a href="#" class="ig"></a></li>
                    <li><a href="#" class="line"></a></li>
                    <li><a href="#" class="fb"></a></li>
                </ul>
            </div>

            <div class="border-s border"></div>
            <div class="copyright-ms">
                <p>Copyright © ClayOfStories 2024 All Rights Reserved</p>
            </div>
        </div>



    </footer>

    <script src="https://unpkg.com/axios@1.6.7/dist/axios.min.js"></script>
    <!-- 載入REACT -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- 啟用jquery原生碼 -->
    <script src="../js/jquery/jquery-3.7.1.min.js"></script>
    <!-- 自訂的js -->
    <script src="../js/index.js"></script>

    <!-- REACT -->
    <script type="text/babel">
        const { useState, useEffect } = React;
        const productId = parseInt(new URLSearchParams(window.location.search).get('id'), 10);

        function Product({ product }) {
            const imgSrc = `../imagesAll/productsDetail/product${productId}`;
            // 左邊產品細節圖，預設用第一張圖片展示
            const [currentImage, setCurrentImage] = useState(`${imgSrc}-a.JPG`);

            const handleImageClick = (event, img) => {
                event.preventDefault();
                setCurrentImage(img);
            };

            return (
                <>  
                <div className="product-card">
                    <div className="back-link">
                        <a href="../index.html">HOME/</a>
                        <a href="./allproduct.html">All Products/</a>
                        <p>{product.name}</p>                       
                    </div>

                    <div className="product-container product-imgs">
                        <div className="left-showImg">
                            <div className="smlpic img-select">
                                <div className="img-item">
                                    <a href="#" data-id="1" onClick={(event) => handleImageClick(event, `${imgSrc}-a.JPG`)}>
                                        <img src={`${imgSrc}-a.JPG`} alt="product image" />
                                    </a>
                                </div>
                                <div className="img-item">
                                    <a href="#" data-id="2" onClick={(event) => handleImageClick(event, `${imgSrc}-b.JPG`)}>
                                        <img src={`${imgSrc}-b.JPG`} alt="product image" />
                                    </a>
                                </div>
                                <div className="img-item">
                                    <a href="#" data-id="3" onClick={(event) => handleImageClick(event, `${imgSrc}-c.JPG`)}>
                                        <img src={`${imgSrc}-c.JPG`} alt="product image" />
                                    </a>
                                </div>
                                <div className="img-item">
                                    <a href="#" data-id="4" onClick={(event) => handleImageClick(event, `${imgSrc}-d.JPG`)}>
                                        <img src={`${imgSrc}-d.JPG`} alt="product image" />
                                    </a>
                                </div>
                            </div>

                            <div className="bigpic img-display">
                                <div className="img-showcase">
                                    <img src={currentImage} alt="product image" />
                                </div>
                            </div>

                        </div>

                        <div className="detail">
                            <small>{product.category}</small>
                            <h1>{product.name}</h1><br />
                            <h2>NT${product.price}</h2><br />
                            <div>
                                <p>Product size： {product.size} cm <br/>
                                    Product description: <br />
                                    {product.description}
                                </p>
                            </div>

                            <div className="btn-con">
                                <button><img src="../imagesAll/images/decrease.svg" alt="" />
                                </button>
                                <span className="count" id="count">1</span>
                                <button><img src="../imagesAll/images/increase.svg" alt="" />
                                </button>
                            </div>

                            <section className="add">
                                <button className="add-to-cart">Add To Cart</button>
                                <img src="../imagesAll/images/product1 1.svg" alt="Product Image" />
                            </section>
                        </div>

                    </div>
                   
                </div>
                <Suggest productId={productId} />
                </>
            );
        }

        // 下方推薦產品區
        function Suggest({ productId }) {
            const [suggestedProducts, setSuggestedProducts] = useState([]);

            useEffect(() => {
                axios.get("https://viiivian.github.io/ClayOfStories-5-24/json/db.json")
                    .then(res => {
                        const products = res.data.products;
                        let suggested = [];


                        if (productId <= 3) {
                            //如果產品id是1, 2 或 3，推薦產品為後三筆
                            suggested = products.slice(productId, productId + 3);
                        } else {
                            //其他都是推薦前三筆
                            suggested = products.slice(productId - 4, productId - 1);
                        }

                        setSuggestedProducts(suggested);
                    })
                    .catch(err => {
                        console.error("Error fetching suggested products:", err);
                    });
            }, [productId]);

            return (
                <section className="promotePro">
                    <h1 className="ymal">You may also like...</h1>
                    <div className="list-box">
                        {suggestedProducts.map((product, index) => (
                            <a href={`product.html?id=${product.id}`} key={product.id}>
                                <div className="box" key={index}>
                                    <div className="suggest-img">
                                        <img src={`../imagesAll/psphoto/psphoto${product.id}.png`} alt={product.name} />

                                    </div>

                                    <div className="suggest-detail">
                                        <h1>{product.name}</h1>
                                        <p className="content">{product.content}</p>
                                        <div className="product-price">
                                            <h6>price</h6>
                                            <p>NT${product.price}</p>
                                        </div>
                                        <div className="select-num">
                                            <h6>price num</h6>
                                            <select name="" id="">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                            </select>
                                        </div>

                                        <button className="suggest-add">ADD TO CART</button>
                                    </div>

                                </div>
                            </a>
                        ))
                        }
                    </div>
                </section>
            );
        }

        function MyApp() {
            const [product, setProduct] = useState(null);
            useEffect(() => {
                if (productId) {
                    axios.get("https://viiivian.github.io/ClayOfStories-5-24/json/db.json")
                        .then(res => {
                            const foundProduct = res.data.products.find(p => p.id === productId);
                            setProduct(foundProduct);
                        })
                        .catch(err => {
                            console.error("Error fetching product:", err);
                            setProduct(null);
                        });
                }
            }, [productId]);

            if (!product) {
                return <p>Loading...</p>;
            }

            return <Product product={product} />;
        }

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<MyApp />);
    </script>



</body>

</html>
    <!-- 購物車新增(待修) -->
    <!-- <script>
        var count = 0;
        var cartCount = 0;
        function increase() {
            count++;
            document.getElementById('count').innerText = count;
        }

        function decrease() {
            if (count > 1) {
                count--;
            }
            document.getElementById('count').innerText = count;
        };
        function addToCart() {
            cartCount += count;
            document.getElementById('cart-count').innerText = cartCount;
            count = 1;
            document.getElementById('count').innerText = count;
        }
    </script> -->