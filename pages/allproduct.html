<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ClayOfStories|手作黏土</title>
  <link rel="icon" href="../imagesAll/indexPic/video-icon2.png">
  <link rel="stylesheet" href="../css/default-set.css" />
  <link rel="stylesheet" href="../css/allproduct.css" />
</head>

<body>
  <header class="topbar">
    <div class="container">
      <div class="left-bar">
        <div class="nav-box">
          <button class="hamburger">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
          </button>
          <div class="navigation">
            <ul class="menu">
              <li><a href="../index.html">HOME</a></li>
              <li><a href="./about.html">ABOUT</a></li>
              <li><a href="./allproduct.html">PRODUCT</a></li>
              <li><a href="./customintro.html">CUSTOM</a></li>
              <li><a href="./contact.html">CONTACT</a></li>
            </ul>
          </div>
        </div>
        <h1 class="logo">
          <a class="logo-s" href="../index.html"><img src="../imagesAll/indexPic/Logo-s.png" alt="品牌LOGO"></a>

          <a class="logo-m" href="../index.html"><img src="../imagesAll/indexPic/newlogo.png" alt="品牌LOGO"></a>
        </h1>

        <nav>
          <ul class="menu">
            <li><a href="../index.html" class="home">
                <span class="translate-en">HOME</span>
                <span class="translate-ch">首頁</span>
              </a> </li>

            <li><a href="./about.html" class="about">
                <span class="translate-en">ABOUT</span>
                <span class="translate-ch">關於</span>
              </a></li>

            <li class="product"> <a href="./allproduct.html" class="product">
                <span class="translate-en">PRODUCT</span>
                <span class="translate-ch">所有產品</span>
              </a>

              <!-- 下拉式選單 -->
              <ul class="menu-drop-L">
                <li>
                  <a href="./allproduct.html">
                    <div class="drop-category">
                      <img src="../imagesAll/indexPic/menu-icon1.png" alt="" />
                      <h3>VIEW ALL</h3>
                    </div>
                  </a>
                </li>

                <li><a href="./allproduct.html">
                    <div class="drop-category">
                      <img src="../imagesAll/indexPic/menu-icon2.png" alt="" />
                      <h3>MIRROR</h3>
                    </div>
                  </a></li>

                <li><a href="./allproduct.html">
                    <div class="drop-category">
                      <img src="../imagesAll/indexPic/menu-icon3.png" alt="" />
                      <h3>TRAY</h3>
                    </div>
                  </a></li>

                <li> <a href="./allproduct.html">
                    <div class="drop-category">
                      <img src="../imagesAll/indexPic/menu-icon4.png" alt="" />
                      <h3>ACCESSORY</h3>
                    </div>
                  </a></li>

                <li><a href="./allproduct.html">
                    <div class="drop-category">
                      <img src="../imagesAll/indexPic/menu-icon5.png" alt="" />
                      <h3>VASE</h3>
                    </div>
                  </a></li>
                <li><a href="./allproduct.html">
                    <div class="drop-category">
                      <img src="../imagesAll/indexPic/menu-icon6.png" alt="" />
                      <h3>HOLDER</h3>
                    </div>
                  </a></li>
              </ul>
            </li>


            <li><a href="./customintro.html" class="customized">
                <span class="translate-en">CUSTOM</span>
                <span class="translate-ch">客製化</span>
              </a></li>
            <li><a href="./contact.html" class="contact">
                <span class="translate-en">CONTACT</span>
                <span class="translate-ch">聯絡我們</span>
              </a></li>
          </ul>
        </nav>
      </div>

      <ul class="right-bar icon">
        <li><a href="./login.html" class="icon-user"></a></li>
        <li><a href="./fqa.html" class="icon-fqa"></a></li>
        <li><a href="./shopcart.html" class="icon-cart"></a></li>
        <span class="cart-count" id="cart-count">0</span>

      </ul>
    </div>

  </header>

  <main class="main">
    <!-- Produt Title -->
    <div class="upper">
      <div class="vase-bkg"><img src="../imagesAll/images/product-title.png" alt=""></div>
      <h1>Products</h1>
    </div>

    <!-- Sidebar for sorting -->

    <div id="root">
    </div>


    <ul class="pagination">
      <li><a href="#"> &lt; </a></li>
      <li><a href="#">1</a></li>
      <li><a href="#">2</a></li>
      <li><a href="#">3</a></li>
      <li><a href="#">4</a></li>
      <li><a href="#">5</a></li>
      <li><a href="#"> &gt; </a></li>
    </ul>


  </main>
  <footer>
    <div class="footer-container">
      <!-- section 1 -->
      <div class="menu">
        <ul class="menu-1">
          <li><a href="../index.html">HOME</a></li>
          <li><a href="./about.html">ABOUT</a></li>
          <li><a href="./allproduct.html">PRODUCT</a></li>

        </ul>

        <ul class="menu-2">
          <li><a href="./customintro.html">CUSTOMIZED</a></li>
          <li><a href="./contact.html">CONTACT</a></li>
          <li><a href="./fqa.html">FAQ</a></li>
        </ul>

      </div>
      <div class="border-s border"></div>

      <!-- section 2 -->
      <div class="container">
        <ul class="icons">
          <li><img src="../imagesAll/indexPic/footer-icon1.png" alt=""></li>
          <li><img src="../imagesAll/indexPic/footer-icon2.png" alt=""></li>
          <li><img src="../imagesAll/indexPic/footer-icon3.png" alt=""></li>
        </ul>

        <div class="border"></div>

        <p>Copyright © ClayOfStories 2024 All Rights Reserved</p>
      </div>

      <!-- section 3 -->
      <div class="information">
        <h4>CONTACT US</h4>
        <p>clayofstories@gmail.com</p>
        <p>0800-523-066</p>
        <ul class="social-media">
          <li><a href="#" class="ig"></a></li>
          <li><a href="#" class="line"></a></li>
          <li><a href="#" class="fb"></a></li>
        </ul>
      </div>

      <div class="border-s border"></div>
      <div class="copyright-ms">
        <p>Copyright © ClayOfStories 2024 All Rights Reserved</p>
      </div>
    </div>



  </footer>




  <!-- 載入axios -->
  <script src="https://unpkg.com/axios@1.6.7/dist/axios.min.js"></script>
  <!-- 載入REACT -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="../js/jquery/jquery-3.7.1.min.js"></script>
  <script src="../js/index.js"></script>

  <script type="text/babel">
    const { useState, useEffect } = React;

    function Product({ product }) {
      const imgSrc = `../imagesAll/psphoto/psphoto${product.id}.png`;
      return (
        <a href={`product.html?id=${product.id}`} key={product.id}>
          <div className="allproducts">
            <img className="default-img" src={imgSrc} alt={product.name} />
            <h3>{product.name}</h3>
            <button>NT${product.price}</button>
          </div>
        </a>
      );
    }

    function MyApp() {
      // 所有產品資料
      const [products, setProducts] = useState([]);
      // 篩選過的產品資料
      const [filteredProducts, setFilteredProducts] = useState([]);
      // 選定的分類(預設是all)
      const [selectedCategory, setSelectedCategory] = useState('all');
      // 選定的排序
      const [sortType, setSortType] = useState('');

      function countCartTotal() {
        const cartCount = document.querySelector('.cart-count');
        let cartlist = JSON.parse(localStorage.getItem('cart'));
        if (!cartlist || cartlist.length === 0) {
          cartCount.innerHTML = '0';
        }
        let total = cartlist.reduce((total, product) => total + product.num, 0);
        cartCount.innerHTML = total.toString();
      }


      useEffect(() => {
        axios.get("https://viiivian.github.io/ClayOfStories-5-24/json/db.json")
          .then(res => {
            setProducts(res.data.products);
            setFilteredProducts(res.data.products);
          })
          .catch(err => {
            console.error("Error fetching products:", err);
            setProducts([]);
            setFilteredProducts([]);
          });
      }, []);
      countCartTotal()

      //  點擊分類
      const handleCategoryChange = (category) => {
        setSelectedCategory(category);
        let filtered;
        if (category === 'all') {
          filtered = products;
        } else {
          // 根據選的種類，篩選產品資料放入filtered
          filtered = products.filter(product => product.category.toLowerCase() === category.toLowerCase());
        }
        handleSortChange(sortType, filtered);
      };

      // 點擊排序
      const handleSortChange = (sortType, productsToSort) => {
        setSortType(sortType);
        // 拷貝分類好的資料到sortedProducts，並排序資料
        let sortedProducts = [...productsToSort];
        if (sortType === 'priceLh') {
          sortedProducts.sort((a, b) => a.price - b.price);
        } else if (sortType === 'priceHl') {
          sortedProducts.sort((a, b) => b.price - a.price);
        } else if (sortType === 'newest') {
          sortedProducts.sort((a, b) => new Date(b.time) - new Date(a.time));
        }
        setFilteredProducts(sortedProducts);
      };


      return (
        <div className="sidebarcontainer">
          <div className="sidebar">
            <div className="sidebar1">
              <h2>Product Type</h2>
              <ul>
                <li>
                  <input type="radio" id="type-all" name="category" value="all" onChange={() => handleCategoryChange('all')} checked={selectedCategory === 'all'} />
                  <label htmlFor="type-all">All</label>
                </li>
                <li>
                  <input type="radio" id="type-mirror" name="category" value="mirror" onChange={() => handleCategoryChange('Mirror')} checked={selectedCategory === 'Mirror'} />
                  <label htmlFor="type-mirror">Mirror</label>
                </li>
                <li>
                  <input type="radio" id="type-tray" name="category" value="jewelrytray" onChange={() => handleCategoryChange('Jewelry-Tray')} checked={selectedCategory === 'Jewelry-Tray'} />
                  <label htmlFor="type-tray">Jewelry Tray</label>
                </li>
                <li>
                  <input type="radio" id="type-accessory" name="category" value="accessory" onChange={() => handleCategoryChange('Accessory')} checked={selectedCategory === 'Accessory'} />
                  <label htmlFor="type-accessory">Accessory</label>
                </li>

                <li>
                  <input type="radio" id="type-vase" name="category" value="flowervase" onChange={() => handleCategoryChange('Flower-Vase')} checked={selectedCategory === 'Flower-Vase'} />
                  <label htmlFor="type-vase">Flower Vase</label>
                </li>

                <li>
                  <input type="radio" id="type-frame" name="category" value="ringholder" onChange={() => handleCategoryChange('Ring-Holder')} checked={selectedCategory === 'Ring-Holder'} />
                  <label htmlFor="type-frame">Ring Holder</label>
                </li>
                <li>
                  <input type="radio" id="type-holder" name="category" value="photoholder" onChange={() => handleCategoryChange('Photo-Holder')} checked={selectedCategory === 'Photo-Holder'} />
                  <label htmlFor="type-holder">Photo holder</label>
                </li>

              </ul>
              <br />
            </div>

            <br />
            <div className="sidebar2">
              <h2>Sort by</h2>
              <ul>
                <li>
                  <input type="radio" id="sort-newest" name="sorting" value="newest" onChange={() => handleSortChange('newest', filteredProducts)} checked={sortType === 'newest'} />
                  <label htmlFor="sort-newest">Newest</label>
                </li>
                <li>
                  <input type="radio" id="sort-priceLh" name="sorting" value="priceLh" onChange={() => handleSortChange('priceLh', filteredProducts)} checked={sortType === 'priceLh'} />
                  <label htmlFor="sort-priceLh">Price (low to high)</label>
                </li>
                <li>
                  <input type="radio" id="sort-priceHl" name="sorting" value="priceHl" onChange={() => handleSortChange('priceHl', filteredProducts)} checked={sortType === 'priceHl'} />
                  <label htmlFor="sort-priceHl">Price (high to low)</label>
                </li>
              </ul>
            </div>
          </div>

          <div className="main-content">
            <div className="product-list">
              {filteredProducts && filteredProducts.length > 0 ? (
                filteredProducts.map(product => (
                  <Product key={product.id} product={product} />
                ))
              ) : (
                <img src="../imagesAll/psphoto/loading.gif" />
              )}
            </div>
          </div>
        </div>
      );
    }
    const container = document.getElementById('root');
    const root = ReactDOM.createRoot(container);
    root.render(<MyApp />);
  </script>

</body>

</html>